<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="icon" href="/images/icons/logo.png"><title>ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç›‘æ§ä¼˜åŒ–ä¸“é¡¹ | æœé˜³ç¬”è®°</title><meta name="description" content="æ·±å…¥è§£æITè¿ç»´å·¥ç¨‹å¸ˆç›‘æ§ä¼˜åŒ–èŒè´£ï¼Œæ¶µç›–Zabbixã€Prometheusç­‰ç›‘æ§å·¥å…·éƒ¨ç½²å’Œèµ„æºä¼˜åŒ–ç­–ç•¥ã€‚">
    <link rel="preload" href="/assets/style-C2QOOv13.css" as="style"><link rel="stylesheet" href="/assets/style-C2QOOv13.css">
    <link rel="modulepreload" href="/assets/app-DbSsbPov.js"><link rel="modulepreload" href="/assets/åº”è˜æŒ‡å—02-ç›‘æ§ä¼˜åŒ–.html-CRt0-oTV.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/ProjectInfo.html-XX7Pw-EX.js" as="script"><link rel="prefetch" href="/assets/index.html-C3lEyyB9.js" as="script"><link rel="prefetch" href="/assets/index.html-CpyLX7dg.js" as="script"><link rel="prefetch" href="/assets/index.html-CHKnWg9n.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼01.html-C4x0MfWq.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼02.html-BRJTic0D.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼03.html-C7DzIBYx.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼04.html-CHpL1wTK.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼05.html-DtNotWRm.js" as="script"><link rel="prefetch" href="/assets/æ—¥æ¼«åœ£åœ°å·¡ç¤¼06.html-DEQFGweL.js" as="script"><link rel="prefetch" href="/assets/index.html-BkWY6aJz.js" as="script"><link rel="prefetch" href="/assets/ä¸€é”®åŠ é€Ÿï¼Œè®©ä½ çš„Windowsæœºæ¢°ç¡¬ç›˜ä¼ è¾“é€Ÿåº¦é£èµ·æ¥!.html-B114NSNe.js" as="script"><link rel="prefetch" href="/assets/å¦‚ä½•åˆ¶ä½œèœ‚èœœæŸ æª¬èŒ¶.html-BFMKX8Ws.js" as="script"><link rel="prefetch" href="/assets/å¦‚ä½•ç§ä¸€æ£µæŸ æª¬æ ‘.html-Dq-2W-UQ.js" as="script"><link rel="prefetch" href="/assets/å¦‚ä½•è·å–ä¼˜è´¨èœ‚èœœ.html-Chw73tlo.js" as="script"><link rel="prefetch" href="/assets/æ ¡å›­æŠ€æœ¯è¿ç»´å¸¸è§å¯¹è¯ç”¨è¯­.html-Csv_EEMY.js" as="script"><link rel="prefetch" href="/assets/ç”µä¿¡è¡Œä¸šé¢è¯•é—®é¢˜å‡†å¤‡.html-BHZ-SA1p.js" as="script"><link rel="prefetch" href="/assets/ç”µä¿¡è¡Œä¸šé¢è¯•é—®é¢˜å‚è€ƒå›ç­”.html-CqEZ8w6V.js" as="script"><link rel="prefetch" href="/assets/ç®€å†ä¸­çš„ä¸ªäººä¼˜åŠ¿å¦‚ä½•æ’°å†™.html-mzSrnLbi.js" as="script"><link rel="prefetch" href="/assets/ç®€å†ä¸­çš„å®ä¹ ç»å†å¦‚ä½•æ’°å†™.html-sPll8uNp.js" as="script"><link rel="prefetch" href="/assets/ç®€å†ä¸­çš„æ•™è‚²ç»å†å¦‚ä½•æ’°å†™.html-DlIK7g09.js" as="script"><link rel="prefetch" href="/assets/è¿ç»´åº”å±Šç”Ÿé¢è¯•é—®é¢˜å‡†å¤‡.html-B07YonRO.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•å¸¸è§é—®é¢˜æ ‡å‡†è§£ç­”ç¤ºä¾‹.html-BDNmIWz5.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•å¸¸è§é—®é¢˜è§£ç­”(1).html-CYJAfsmD.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•å¸¸è§é—®é¢˜è§£ç­”(2).html-DKLCh9ON.js" as="script"><link rel="prefetch" href="/assets/é¢è¯•å¸¸è§é—®é¢˜è§£ç­”(3).html-Om4tMAFK.js" as="script"><link rel="prefetch" href="/assets/index.html-C0lSAkpx.js" as="script"><link rel="prefetch" href="/assets/Vue2è„šæ‰‹æ¶å¿«é€Ÿæ­å»º.html-BeC8gABj.js" as="script"><link rel="prefetch" href="/assets/Vue3è„šæ‰‹æ¶å¿«é€Ÿæ­å»º.html-B8rB2cK1.js" as="script"><link rel="prefetch" href="/assets/GitSubmoduleä½¿ç”¨æŒ‡å—.html-C93x9g2f.js" as="script"><link rel="prefetch" href="/assets/Gitå­æ¨¡å—å¼ºåˆ¶æ›´æ–°ä¸è·¯å¾„é‡é…ç½®æŒ‡å—.html-BF2Rt7rK.js" as="script"><link rel="prefetch" href="/assets/ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—.html-lnmNucor.js" as="script"><link rel="prefetch" href="/assets/ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆèŒä½è¯¦è§£ä¸åº”è˜æŒ‡å—.html-DkVM8S8x.js" as="script"><link rel="prefetch" href="/assets/Linuxç³»ç»ŸTaræ‰“åŒ…ç›®å½•.html-DFUUCYp5.js" as="script"><link rel="prefetch" href="/assets/Linuxç³»ç»Ÿä¸­çš„cgroupsçš„äº†è§£ä¸åº”ç”¨.html-Dqi20IhO.js" as="script"><link rel="prefetch" href="/assets/MySQLä½¿ç”¨UUIDå‡½æ•°è‡ªåŠ¨ç”Ÿæˆuuidå¹¶æ’å…¥æŒ‡å®šåˆ—.html-CKuH6phS.js" as="script"><link rel="prefetch" href="/assets/MySQLç”Ÿæˆåˆ—è¡¨åºå·ï¼ˆ1ï¼‰.html-BdUXydZh.js" as="script"><link rel="prefetch" href="/assets/MySQLç”Ÿæˆåˆ—è¡¨åºå·ï¼ˆ2ï¼‰.html-D1d2I3XJ.js" as="script"><link rel="prefetch" href="/assets/MySQLè¡¨ä¸è¡¨ä¹‹é—´æ•°æ®çš„åŒæ­¥.html-B9x86FZn.js" as="script"><link rel="prefetch" href="/assets/index.html-DbaaDp_1.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—01-åŸºç¡€è®¾æ–½ç®¡ç†.html-BeJDSk4O.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—03-æ•…éšœå¤„ç†ä¸æŠ€æœ¯æ”¯æŒ.html-C1qGBEwf.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—04-å®‰å…¨ç®¡ç†.html-3Ez1iiZu.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—05-æ€§èƒ½ä¼˜åŒ–.html-C9D5Ocz7.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—06-é¡¹ç›®ç®¡ç†.html-BxzWyITx.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—07-ç¾å¤‡ç®¡ç†.html-CW11wkzC.js" as="script"><link rel="prefetch" href="/assets/åº”è˜æŒ‡å—08-æŠ¥å‘Šæ’°å†™.html-BlBsOf_4.js" as="script"><link rel="prefetch" href="/assets/index.html-BbQfkwrj.js" as="script"><link rel="prefetch" href="/assets/404.html-Bq1adknL.js" as="script"><link rel="prefetch" href="/assets/index.html-DetM50yF.js" as="script"><link rel="prefetch" href="/assets/index.html-JnT5t07m.js" as="script"><link rel="prefetch" href="/assets/index.html-BJfcpsuv.js" as="script"><link rel="prefetch" href="/assets/index.html-BItHCkhR.js" as="script"><link rel="prefetch" href="/assets/index.html-Biihc6PP.js" as="script"><link rel="prefetch" href="/assets/index.html-D2yjT-50.js" as="script"><link rel="prefetch" href="/assets/index.html-Cqz3tbXR.js" as="script"><link rel="prefetch" href="/assets/index.html-DBfIwd7W.js" as="script"><link rel="prefetch" href="/assets/index.html-C1OfHjyO.js" as="script"><link rel="prefetch" href="/assets/index.html-mGVAxyZS.js" as="script"><link rel="prefetch" href="/assets/index.html-DaT5CkiX.js" as="script"><link rel="prefetch" href="/assets/index.html-DsNt3ODS.js" as="script"><link rel="prefetch" href="/assets/index.html-D5EPFlxf.js" as="script"><link rel="prefetch" href="/assets/index.html-Bjnz1LJa.js" as="script"><link rel="prefetch" href="/assets/index.html-Bys3Dks8.js" as="script"><link rel="prefetch" href="/assets/index.html-DDXDWIDm.js" as="script"><link rel="prefetch" href="/assets/index.html-C_QWHKG6.js" as="script"><link rel="prefetch" href="/assets/index.html-BrNV7JWZ.js" as="script"><link rel="prefetch" href="/assets/index.html-Dr9LretO.js" as="script"><link rel="prefetch" href="/assets/index.html-DVWfl9zD.js" as="script"><link rel="prefetch" href="/assets/index.html-D4BpuwgO.js" as="script"><link rel="prefetch" href="/assets/index.html-Zfu_vn5y.js" as="script"><link rel="prefetch" href="/assets/index.html-BasFJqfR.js" as="script"><link rel="prefetch" href="/assets/index.html-DQ-y2xZj.js" as="script"><link rel="prefetch" href="/assets/index.html-D01yduSy.js" as="script"><link rel="prefetch" href="/assets/index.html-DbMldL56.js" as="script"><link rel="prefetch" href="/assets/index.html-BazxZmx2.js" as="script"><link rel="prefetch" href="/assets/index.html-CooBigh-.js" as="script"><link rel="prefetch" href="/assets/index.html-HbJQeqlZ.js" as="script"><link rel="prefetch" href="/assets/index.html-RrblcdEl.js" as="script"><link rel="prefetch" href="/assets/index.html-DhrEquuR.js" as="script"><link rel="prefetch" href="/assets/index.html-DCtxWv7e.js" as="script"><link rel="prefetch" href="/assets/index.html-CStVRvuO.js" as="script"><link rel="prefetch" href="/assets/index.html-B1hqugVr.js" as="script"><link rel="prefetch" href="/assets/index.html-D8eTxCzX.js" as="script"><link rel="prefetch" href="/assets/index.html-CfeEaUkK.js" as="script"><link rel="prefetch" href="/assets/index.html-DrpdecoE.js" as="script"><link rel="prefetch" href="/assets/index.html-hUqirUpt.js" as="script"><link rel="prefetch" href="/assets/index.html-B_f3uuBn.js" as="script"><link rel="prefetch" href="/assets/index.html-BO-XVJQe.js" as="script"><link rel="prefetch" href="/assets/index.html-C0s4xzsE.js" as="script"><link rel="prefetch" href="/assets/index.html-ZKF0PlIL.js" as="script"><link rel="prefetch" href="/assets/index.html-Tfn-3GL9.js" as="script"><link rel="prefetch" href="/assets/index.html-z4E8hQEe.js" as="script"><link rel="prefetch" href="/assets/index.html-DU0i2mwA.js" as="script"><link rel="prefetch" href="/assets/index.html-BGfzSCcd.js" as="script"><link rel="prefetch" href="/assets/index.html-vbtaNB5U.js" as="script"><link rel="prefetch" href="/assets/index.html-BlvLet2Q.js" as="script"><link rel="prefetch" href="/assets/index.html-0IqKdVWd.js" as="script"><link rel="prefetch" href="/assets/index.html-B4pWcZwR.js" as="script"><link rel="prefetch" href="/assets/index.html-Dc4aeiuL.js" as="script"><link rel="prefetch" href="/assets/index.html-n6_q-vGm.js" as="script"><link rel="prefetch" href="/assets/index.html-8utYNIuG.js" as="script"><link rel="prefetch" href="/assets/index.html-CMJdSmHo.js" as="script"><link rel="prefetch" href="/assets/index.html-CnZq7T2N.js" as="script"><link rel="prefetch" href="/assets/index.html-17SKcIfS.js" as="script"><link rel="prefetch" href="/assets/index.html-WphuKIAt.js" as="script"><link rel="prefetch" href="/assets/index.html-CqS7Z5ig.js" as="script"><link rel="prefetch" href="/assets/index.html-DcSq9aR4.js" as="script"><link rel="prefetch" href="/assets/index.html-Br61Cxkp.js" as="script"><link rel="prefetch" href="/assets/index.html-C2R_tlEB.js" as="script"><link rel="prefetch" href="/assets/index.html-mw0fNENh.js" as="script"><link rel="prefetch" href="/assets/index.html-D1koBjYa.js" as="script"><link rel="prefetch" href="/assets/index.html-D3vOiH2t.js" as="script"><link rel="prefetch" href="/assets/index.html-Dob2Jg3y.js" as="script"><link rel="prefetch" href="/assets/index.html-CG2GBDQm.js" as="script"><link rel="prefetch" href="/assets/index.html-Dhwte7Sq.js" as="script"><link rel="prefetch" href="/assets/index.html-D0BzvMly.js" as="script"><link rel="prefetch" href="/assets/index.html-DQzJEzXa.js" as="script"><link rel="prefetch" href="/assets/index.html-DaHGM6ef.js" as="script"><link rel="prefetch" href="/assets/index.html-BqYZ7L0E.js" as="script"><link rel="prefetch" href="/assets/index.html-B7ua8B9h.js" as="script"><link rel="prefetch" href="/assets/index.html-BbS1Fgr5.js" as="script"><link rel="prefetch" href="/assets/index.html-C_WleMFN.js" as="script"><link rel="prefetch" href="/assets/index.html-DpdbdFPz.js" as="script"><link rel="prefetch" href="/assets/index.html-BDY7Rhmj.js" as="script"><link rel="prefetch" href="/assets/index.html-CvT0vfVv.js" as="script"><link rel="prefetch" href="/assets/index.html-DdnClmZD.js" as="script"><link rel="prefetch" href="/assets/index.html-pxeRxnfg.js" as="script"><link rel="prefetch" href="/assets/index.html-C0WHUHqE.js" as="script"><link rel="prefetch" href="/assets/index.html-jh3OQ4gC.js" as="script"><link rel="prefetch" href="/assets/index.html-BpYzAKeN.js" as="script"><link rel="prefetch" href="/assets/index.html-Cu1i9Vc7.js" as="script"><link rel="prefetch" href="/assets/index.html-DQN8nw0D.js" as="script"><link rel="prefetch" href="/assets/index.html-DyZxO03Q.js" as="script"><link rel="prefetch" href="/assets/index.html-CUC4fvs6.js" as="script"><link rel="prefetch" href="/assets/index.html-B33v63-H.js" as="script"><link rel="prefetch" href="/assets/index.html-asG8LhIV.js" as="script"><link rel="prefetch" href="/assets/index.html-DOzCl3Re.js" as="script"><link rel="prefetch" href="/assets/index.html-DEzMtRAk.js" as="script"><link rel="prefetch" href="/assets/index.html-DcNkZj02.js" as="script"><link rel="prefetch" href="/assets/index.html-CwG7-q0_.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy0jab47.js" as="script"><link rel="prefetch" href="/assets/index.html-BYeZN3Yx.js" as="script"><link rel="prefetch" href="/assets/index.html-Y_-ZZoLo.js" as="script"><link rel="prefetch" href="/assets/index.html-fgVuwUhx.js" as="script"><link rel="prefetch" href="/assets/index.html-egMxhez4.js" as="script"><link rel="prefetch" href="/assets/index.html-bh3j_YXq.js" as="script"><link rel="prefetch" href="/assets/index.html-CFP7ordl.js" as="script"><link rel="prefetch" href="/assets/index.html-D2107Ykz.js" as="script"><link rel="prefetch" href="/assets/index.html-B65YUGxn.js" as="script"><link rel="prefetch" href="/assets/index.html-DFASwFdw.js" as="script"><link rel="prefetch" href="/assets/index.html-zNCOMVno.js" as="script"><link rel="prefetch" href="/assets/index.html-CGQh4aNQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DsMdPpJi.js" as="script"><link rel="prefetch" href="/assets/index.html-BCyLhUZl.js" as="script"><link rel="prefetch" href="/assets/index.html-DLWmZaxq.js" as="script"><link rel="prefetch" href="/assets/index.html-BNz7aqNu.js" as="script"><link rel="prefetch" href="/assets/index.html-DaCr_du8.js" as="script"><link rel="prefetch" href="/assets/index.html-nB7JeFU3.js" as="script"><link rel="prefetch" href="/assets/index.html-DjR69S3j.js" as="script"><link rel="prefetch" href="/assets/index.html-CGvgYKn5.js" as="script"><link rel="prefetch" href="/assets/index.html-DcgV2w1A.js" as="script"><link rel="prefetch" href="/assets/index.html-QBX4Je0T.js" as="script"><link rel="prefetch" href="/assets/index.html-Bk9e54pS.js" as="script"><link rel="prefetch" href="/assets/index.html-CLGr29PJ.js" as="script"><link rel="prefetch" href="/assets/index.html-drNdYcJV.js" as="script"><link rel="prefetch" href="/assets/index.html-CmCRBr6l.js" as="script"><link rel="prefetch" href="/assets/index.html-QQAzpBv4.js" as="script"><link rel="prefetch" href="/assets/index.html-ofn9lb-l.js" as="script"><link rel="prefetch" href="/assets/index.html-D7s7-Q8n.js" as="script"><link rel="prefetch" href="/assets/index.html-Dku2ztqL.js" as="script"><link rel="prefetch" href="/assets/index.html-IxZjkDkr.js" as="script"><link rel="prefetch" href="/assets/index.html-DscRkmSC.js" as="script"><link rel="prefetch" href="/assets/index.html-CbRS3Gio.js" as="script"><link rel="prefetch" href="/assets/index.html-D3faVSGc.js" as="script"><link rel="prefetch" href="/assets/index.html-zsS1U7wZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BOg4PdPO.js" as="script"><link rel="prefetch" href="/assets/index.html-CHg2lU1F.js" as="script"><link rel="prefetch" href="/assets/index.html-BKY-rz1B.js" as="script"><link rel="prefetch" href="/assets/index.html-BGUzjIlJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CiRfzXUc.js" as="script"><link rel="prefetch" href="/assets/index.html-BRud4yRg.js" as="script"><link rel="prefetch" href="/assets/index.html-DcQ7xIH-.js" as="script"><link rel="prefetch" href="/assets/index.html-BaQ85NWB.js" as="script"><link rel="prefetch" href="/assets/index.html-5lLKV3wD.js" as="script"><link rel="prefetch" href="/assets/index.html-B-s6xeG9.js" as="script"><link rel="prefetch" href="/assets/index.html-B4CzhyFG.js" as="script"><link rel="prefetch" href="/assets/index.html-CdBzclGb.js" as="script"><link rel="prefetch" href="/assets/index.html-Dt8IsSrk.js" as="script"><link rel="prefetch" href="/assets/index.html-DZRtPOAS.js" as="script"><link rel="prefetch" href="/assets/index.html-C1VZ122X.js" as="script"><link rel="prefetch" href="/assets/index.html-C5zDR9zr.js" as="script"><link rel="prefetch" href="/assets/index.html-Dri_LnMJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CHReJVCq.js" as="script"><link rel="prefetch" href="/assets/index.html-DpO5Z3lf.js" as="script"><link rel="prefetch" href="/assets/index.html-D76leA7P.js" as="script"><link rel="prefetch" href="/assets/index.html-C_K5_tIK.js" as="script"><link rel="prefetch" href="/assets/index.html-D8qCCn3i.js" as="script"><link rel="prefetch" href="/assets/index.html-CsJPpqlO.js" as="script"><link rel="prefetch" href="/assets/index.html-7tXpLWP7.js" as="script"><link rel="prefetch" href="/assets/index.html-s4Bnvdt5.js" as="script"><link rel="prefetch" href="/assets/index.html-ByidkWbH.js" as="script"><link rel="prefetch" href="/assets/index.html-BdWMgh-z.js" as="script"><link rel="prefetch" href="/assets/index.html-kxpmuSNU.js" as="script"><link rel="prefetch" href="/assets/index.html-BieA8XBt.js" as="script"><link rel="prefetch" href="/assets/index.html-xwJnNlX6.js" as="script"><link rel="prefetch" href="/assets/index.html-DOibxyA3.js" as="script"><link rel="prefetch" href="/assets/index.html-DcrB-nMX.js" as="script"><link rel="prefetch" href="/assets/index.html-BfCmbYw0.js" as="script"><link rel="prefetch" href="/assets/index.html-CNR_5sar.js" as="script"><link rel="prefetch" href="/assets/index.html-ocLG42mJ.js" as="script"><link rel="prefetch" href="/assets/index.html-C0YtZB9i.js" as="script"><link rel="prefetch" href="/assets/index.html-DLfqmALI.js" as="script"><link rel="prefetch" href="/assets/index.html-iom1NTZn.js" as="script"><link rel="prefetch" href="/assets/index.html-CE9t_MRD.js" as="script"><link rel="prefetch" href="/assets/index.html-D3hbblz6.js" as="script"><link rel="prefetch" href="/assets/index.html-TfHnJnOE.js" as="script"><link rel="prefetch" href="/assets/index.html-DFi0LVhX.js" as="script"><link rel="prefetch" href="/assets/index.html-Buph8CfN.js" as="script"><link rel="prefetch" href="/assets/index.html-DwLLu6CN.js" as="script"><link rel="prefetch" href="/assets/index.html-2rSTTQeU.js" as="script"><link rel="prefetch" href="/assets/index.html-CoAm46la.js" as="script"><link rel="prefetch" href="/assets/index.html-Ce7upw1l.js" as="script"><link rel="prefetch" href="/assets/index.html-DtziYZFk.js" as="script"><link rel="prefetch" href="/assets/index.html-CWsj7L1B.js" as="script"><link rel="prefetch" href="/assets/index.html-DTU4sukE.js" as="script"><link rel="prefetch" href="/assets/index.html-CAqK8pSp.js" as="script"><link rel="prefetch" href="/assets/index.html-Dixc93Yv.js" as="script"><link rel="prefetch" href="/assets/index.html-B9U57Ij7.js" as="script"><link rel="prefetch" href="/assets/index.html-Dt-P1bGF.js" as="script"><link rel="prefetch" href="/assets/index.html-EgAktFqR.js" as="script"><link rel="prefetch" href="/assets/index.html-Cucv5uss.js" as="script"><link rel="prefetch" href="/assets/index.html-ouoEz3-K.js" as="script"><link rel="prefetch" href="/assets/index.html-BrgVV0q7.js" as="script"><link rel="prefetch" href="/assets/index.html-CXhnlxeD.js" as="script"><link rel="prefetch" href="/assets/index.html-Ca2KHrio.js" as="script"><link rel="prefetch" href="/assets/index.html-BaBAPxl8.js" as="script"><link rel="prefetch" href="/assets/index.html-hC1kkUQz.js" as="script"><link rel="prefetch" href="/assets/index.html-2B-8raTL.js" as="script"><link rel="prefetch" href="/assets/index.html-Ckg8dPrq.js" as="script"><link rel="prefetch" href="/assets/index.html-CnKaQrgD.js" as="script"><link rel="prefetch" href="/assets/index.html-B2OJrxbh.js" as="script"><link rel="prefetch" href="/assets/index.html-BA1VCMFc.js" as="script"><link rel="prefetch" href="/assets/index.html-DkXABbEy.js" as="script"><link rel="prefetch" href="/assets/index.html-cxYsVQoZ.js" as="script"><link rel="prefetch" href="/assets/index.html-B4PT6DhT.js" as="script"><link rel="prefetch" href="/assets/index.html-B6q6Uhrs.js" as="script"><link rel="prefetch" href="/assets/index.html-DD4sQwnK.js" as="script"><link rel="prefetch" href="/assets/index.html-B8WxSGMg.js" as="script"><link rel="prefetch" href="/assets/index.html-BM-p9zt6.js" as="script"><link rel="prefetch" href="/assets/index.html-kQ201I43.js" as="script"><link rel="prefetch" href="/assets/index.html-C_9qgDsZ.js" as="script"><link rel="prefetch" href="/assets/index.html-CymUWGo0.js" as="script"><link rel="prefetch" href="/assets/index.html-szNdM9Uh.js" as="script"><link rel="prefetch" href="/assets/index.html-DOfUtwwm.js" as="script"><link rel="prefetch" href="/assets/index.html-tdWOeMtz.js" as="script"><link rel="prefetch" href="/assets/index.html-C83d5SBf.js" as="script"><link rel="prefetch" href="/assets/index.html-B5l53XGN.js" as="script"><link rel="prefetch" href="/assets/index.html-DytvKjHt.js" as="script"><link rel="prefetch" href="/assets/index.html-BWPJZSiV.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-CKV1Bsxh.js" as="script"><link rel="prefetch" href="/assets/SearchResult-6lZbPLIx.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/images/icons/logo.png" alt><!----><span class="vp-site-name hide-in-pad">æœé˜³ç¬”è®°</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><i class="vp-icon fas fa-house" sizing="height"></i><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/article/" aria-label="æ–‡ç« "><!--[--><i class="vp-icon fas fa-newspaper" sizing="height"></i><!--]-->æ–‡ç« <!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/category/" aria-label="åˆ†ç±»"><!--[--><i class="vp-icon fas fa-folder-open" sizing="height"></i><!--]-->åˆ†ç±»<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/tag/" aria-label="æ ‡ç­¾"><!--[--><i class="vp-icon fas fa-tags" sizing="height"></i><!--]-->æ ‡ç­¾<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="æ—¶é—´çº¿"><!--[--><i class="vp-icon fas fa-clock" sizing="height"></i><!--]-->æ—¶é—´çº¿<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/SunshineCloudTech/SunshineCloudTech.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><!--[--><button type="button" class="slimsearch-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="slimsearch-placeholder">æœç´¢</div><div class="slimsearch-key-hints"><kbd class="slimsearch-key">Ctrl</kbd><kbd class="slimsearch-key">K</kbd></div></button><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="æœé˜³ç¬”è®° (SunshineNotes)"><!--[--><img class="vp-icon" src="/images/icons/logo.png" alt aria-hidden no-view sizing="both"><!--]-->æœé˜³ç¬”è®° (SunshineNotes)<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><i class="vp-icon fas fa-solid fa-server fa-fw" sizing="both"></i><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/" aria-label="è¿ç»´ç¬”è®°"><!---->è¿ç»´ç¬”è®°<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/GitSubmodule%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html" aria-label="Git Submodule ä½¿ç”¨æŒ‡å—"><!--[--><i class="vp-icon fas fa-code-branch fa-fw" sizing="both"></i><!--]-->Git Submodule ä½¿ç”¨æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/Git%E5%AD%90%E6%A8%A1%E5%9D%97%E5%BC%BA%E5%88%B6%E6%9B%B4%E6%96%B0%E4%B8%8E%E8%B7%AF%E5%BE%84%E9%87%8D%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html" aria-label="Git Submodule å¼ºåˆ¶æ›´æ–°ä¸è·¯å¾„é‡é…ç½®æŒ‡å—"><!--[--><i class="vp-icon fas fa-code-branch fa-fw" sizing="both"></i><!--]-->Git Submodule å¼ºåˆ¶æ›´æ–°ä¸è·¯å¾„é‡é…ç½®æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/IT%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%97.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—"><!--[--><i class="vp-icon fas fa-user-gear fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9701-%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šåŸºç¡€è®¾æ–½ç®¡ç†ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-server fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šåŸºç¡€è®¾æ–½ç®¡ç†ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9704-%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šå®‰å…¨ç®¡ç†ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-shield-halved fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šå®‰å…¨ç®¡ç†ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9705-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæ€§èƒ½ä¼˜åŒ–ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-gauge-high fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæ€§èƒ½ä¼˜åŒ–ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9708-%E6%8A%A5%E5%91%8A%E6%92%B0%E5%86%99.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæŠ¥å‘Šæ’°å†™ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-file-lines fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæŠ¥å‘Šæ’°å†™ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9703-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæ•…éšœå¤„ç†ä¸æŠ€æœ¯æ”¯æŒä¸“é¡¹"><!--[--><i class="vp-icon fas fa-tools fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šæ•…éšœå¤„ç†ä¸æŠ€æœ¯æ”¯æŒä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9707-%E7%81%BE%E5%A4%87%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç¾å¤‡ç®¡ç†ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-life-ring fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç¾å¤‡ç®¡ç†ä¸“é¡¹<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9702-%E7%9B%91%E6%8E%A7%E4%BC%98%E5%8C%96.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç›‘æ§ä¼˜åŒ–ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-chart-line fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç›‘æ§ä¼˜åŒ–ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9706-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šé¡¹ç›®ç®¡ç†ä¸“é¡¹"><!--[--><i class="vp-icon fas fa-project-diagram fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šé¡¹ç›®ç®¡ç†ä¸“é¡¹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/IT%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%81%8C%E4%BD%8D%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%97.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆèŒä½è¯¦è§£ä¸åº”è˜æŒ‡å—"><!--[--><i class="vp-icon fas fa-briefcase fa-fw" sizing="both"></i><!--]-->ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆèŒä½è¯¦è§£ä¸åº”è˜æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/Linux%E7%B3%BB%E7%BB%9FTar%E6%89%93%E5%8C%85%E7%9B%AE%E5%BD%95.html" aria-label="Linuxç³»ç»ŸTaræ‰“åŒ…ç›®å½•å®Œå…¨æŒ‡å—"><!--[--><i class="vp-icon fas fa-terminal fa-fw" sizing="both"></i><!--]-->Linuxç³»ç»ŸTaræ‰“åŒ…ç›®å½•å®Œå…¨æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/Linux%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84cgroups%E7%9A%84%E4%BA%86%E8%A7%A3%E4%B8%8E%E5%BA%94%E7%94%A8.html" aria-label="Linuxç³»ç»Ÿä¸­çš„cgroupsæ·±åº¦è§£æä¸å®æˆ˜åº”ç”¨"><!--[--><i class="vp-icon fas fa-layer-group fa-fw" sizing="both"></i><!--]-->Linuxç³»ç»Ÿä¸­çš„cgroupsæ·±åº¦è§£æä¸å®æˆ˜åº”ç”¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/MySQL%E4%BD%BF%E7%94%A8UUID%E5%87%BD%E6%95%B0%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90uuid%E5%B9%B6%E6%8F%92%E5%85%A5%E6%8C%87%E5%AE%9A%E5%88%97.html" aria-label="MySQLä½¿ç”¨UUIDå‡½æ•°è‡ªåŠ¨ç”Ÿæˆuuidå¹¶æ’å…¥æŒ‡å®šåˆ—"><!--[--><i class="vp-icon fas fa-database fa-fw" sizing="both"></i><!--]-->MySQLä½¿ç”¨UUIDå‡½æ•°è‡ªåŠ¨ç”Ÿæˆuuidå¹¶æ’å…¥æŒ‡å®šåˆ—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/MySQL%E7%94%9F%E6%88%90%E5%88%97%E8%A1%A8%E5%BA%8F%E5%8F%B7%EF%BC%881%EF%BC%89.html" aria-label="MySQLç”Ÿæˆéšæœºæ•°å­—ä¸åºåˆ—å·çš„å®Œæ•´æŒ‡å—"><!--[--><i class="vp-icon fas fa-shuffle fa-fw" sizing="both"></i><!--]-->MySQLç”Ÿæˆéšæœºæ•°å­—ä¸åºåˆ—å·çš„å®Œæ•´æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/MySQL%E8%A1%A8%E4%B8%8E%E8%A1%A8%E4%B9%8B%E9%97%B4%E6%95%B0%E6%8D%AE%E7%9A%84%E5%90%8C%E6%AD%A5.html" aria-label="MySQLè¡¨ä¸è¡¨ä¹‹é—´æ•°æ®åŒæ­¥çš„å®Œæ•´æŒ‡å—"><!--[--><i class="vp-icon fas fa-arrows-rotate fa-fw" sizing="both"></i><!--]-->MySQLè¡¨ä¸è¡¨ä¹‹é—´æ•°æ®åŒæ­¥çš„å®Œæ•´æŒ‡å—<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/MySQL%E7%94%9F%E6%88%90%E5%88%97%E8%A1%A8%E5%BA%8F%E5%8F%B7%EF%BC%882%EF%BC%89.html" aria-label="MySQLè¿ç»­åºåˆ—ç”Ÿæˆä¸AUTO_INCREMENTç®¡ç†æŒ‡å—"><!--[--><i class="vp-icon fas fa-list-ol fa-fw" sizing="both"></i><!--]-->MySQLè¿ç»­åºåˆ—ç”Ÿæˆä¸AUTO_INCREMENTç®¡ç†æŒ‡å—<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-pen-to-square fa-fw" sizing="both"></i><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/%E6%9C%9D%E9%98%B3%E7%AC%94%E8%AE%B0/" aria-label="æœé˜³ç¬”è®°"><!---->æœé˜³ç¬”è®°<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-code fa-fw" sizing="both"></i><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/%E7%BC%96%E7%A8%8B%E7%9B%B8%E5%85%B3/" aria-label="ç¼–ç¨‹ç›¸å…³"><!---->ç¼–ç¨‹ç›¸å…³<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-plane-departure fa-fw" sizing="both"></i><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/%E6%97%85%E8%A1%8C%E6%97%A5%E8%AE%B0/" aria-label="æ—…è¡Œæ—¥è®°"><!---->æ—…è¡Œæ—¥è®°<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-folder-open fa-fw" sizing="both"></i><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/" aria-label="é¡¹ç›®æ–‡æ¡£"><!---->é¡¹ç›®æ–‡æ¡£<!----></a><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="/images/backgrounds/background2-min.png" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fas fa-chart-line" sizing="height"></i>ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç›‘æ§ä¼˜åŒ–ä¸“é¡¹</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">SunshineCloud</span></span><span property="author" content="SunshineCloud"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2024/3/5</span><meta property="datePublished" content="2024-03-05T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 20 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT20M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color5 clickable" role="navigation">è¿ç»´ç¬”è®°</span><span class="page-category-item color2 clickable" role="navigation">èŒä¸šå‘å±•</span><span class="page-category-item color6 clickable" role="navigation">é¢è¯•æŒ‡å¯¼</span><!--]--><meta property="articleSection" content="è¿ç»´ç¬”è®°,èŒä¸šå‘å±•,é¢è¯•æŒ‡å¯¼"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">è¿ç»´å·¥ç¨‹å¸ˆ</span><span class="page-tag-item color2 clickable" role="navigation">ç³»ç»Ÿç›‘æ§</span><span class="page-tag-item color3 clickable" role="navigation">æ€§èƒ½ä¼˜åŒ–</span><span class="page-tag-item color3 clickable" role="navigation">æˆæœ¬æ§åˆ¶</span><span class="page-tag-item color6 clickable" role="navigation">æ—¥å¿—åˆ†æ</span><!--]--><meta property="keywords" content="è¿ç»´å·¥ç¨‹å¸ˆ,ç³»ç»Ÿç›‘æ§,æ€§èƒ½ä¼˜åŒ–,æˆæœ¬æ§åˆ¶,æ—¥å¿—åˆ†æ"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="itç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—02-ç›‘æ§ä¼˜åŒ–ä¸“é¡¹æŒ‡å—" tabindex="-1"><a class="header-anchor" href="#itç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—02-ç›‘æ§ä¼˜åŒ–ä¸“é¡¹æŒ‡å—"><span>ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—02 - ç›‘æ§ä¼˜åŒ–ä¸“é¡¹æŒ‡å—</span></a></h1><h2 id="å²—ä½èŒè´£é‡ç‚¹" tabindex="-1"><a class="header-anchor" href="#å²—ä½èŒè´£é‡ç‚¹"><span>å²—ä½èŒè´£é‡ç‚¹</span></a></h2><p><strong>ç›‘æ§ITèµ„æºä½¿ç”¨æƒ…å†µï¼Œä¼˜åŒ–æˆæœ¬;æå‡ºæˆæœ¬èŠ‚çº¦æ–¹æ¡ˆï¼Œå¦‚èµ„æºæ•´åˆã€äº‘æœåŠ¡ä¼˜åŒ–ç­‰;å®šæœŸæ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šä¸”åŠæ—¶å‘ç°å¹¶è§£å†³æ½œåœ¨é—®é¢˜</strong></p><hr><h2 id="ä¸€ã€ç›‘æ§ç³»ç»Ÿéƒ¨ç½²è¯¦ç»†æ“ä½œæŒ‡å—" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€ç›‘æ§ç³»ç»Ÿéƒ¨ç½²è¯¦ç»†æ“ä½œæŒ‡å—"><span>ä¸€ã€ç›‘æ§ç³»ç»Ÿéƒ¨ç½²è¯¦ç»†æ“ä½œæŒ‡å—</span></a></h2><h3 id="_1-1-zabbixç›‘æ§ç³»ç»Ÿéƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#_1-1-zabbixç›‘æ§ç³»ç»Ÿéƒ¨ç½²"><span>1.1 Zabbixç›‘æ§ç³»ç»Ÿéƒ¨ç½²</span></a></h3><h4 id="zabbix-serverå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#zabbix-serverå®‰è£…é…ç½®"><span>Zabbix Serverå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. ç³»ç»Ÿç¯å¢ƒå‡†å¤‡ï¼ˆCentOS 8ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. å®‰è£…Zabbixä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Uvh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://repo.zabbix.com/zabbix/6.0/rhel/8/x86_64/zabbix-release-6.0-4.el8.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å®‰è£…ZabbixæœåŠ¡å™¨å’ŒWebå‰ç«¯</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-web-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-apache-conf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-sql-scripts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-selinux-policy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. å®‰è£…MariaDBæ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. é…ç½®æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql_secure_installation</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CREATE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DATABASE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> CHARACTER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SET</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> utf8mb4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> COLLATE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> utf8mb4_bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CREATE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;zabbix&#39;@&#39;localhost&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IDENTIFIED</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> BY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Zabbix@123!&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">GRANT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PRIVILEGES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ON</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;zabbix&#39;@&#39;localhost&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SET</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GLOBAL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log_bin_trust_function_creators</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">quit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6. å¯¼å…¥æ•°æ®åº“ç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zcat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/zabbix-sql-scripts/mysql/server.sql.gz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --default-character-set=utf8mb4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uzabbix</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 7. é…ç½®ZabbixæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/zabbix_server.conf</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DBPassword</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Zabbix@123!</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DBHost</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">localhost</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DBName</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DBUser</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é…ç½®æ—¥å¿—çº§åˆ«å’Œæ–‡ä»¶å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LogLevel</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LogFile</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/var/log/zabbix/zabbix_server.log</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LogFileSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é…ç½®ç¼“å­˜å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CacheSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">128M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HistoryCacheSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">64M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HistoryIndexCacheSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">32M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TrendCacheSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">32M</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 8. é…ç½®PHP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/php-fpm.d/zabbix.conf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å–æ¶ˆæ³¨é‡Šå¹¶è®¾ç½®æ—¶åŒº</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">php_value[date.timezone]</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Asia/Shanghai</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 9. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php-fpm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php-fpm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 10. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-service=http</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=10051/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 11. Webç•Œé¢é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¿é—® http://server_ip/zabbix</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é»˜è®¤ç”¨æˆ·åï¼šAdminï¼Œå¯†ç ï¼šzabbix</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="zabbix-agentå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#zabbix-agentå®‰è£…é…ç½®"><span>Zabbix Agentå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. åœ¨è¢«ç›‘æ§ä¸»æœºä¸Šå®‰è£…Agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®Agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/zabbix_agent2.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æœåŠ¡å™¨é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Server</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">192.168.1.100</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ServerActive</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">192.168.1.100</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Hostname</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">web-server-01</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®‰å…¨é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">AllowKey</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">system.run[*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DenyKey</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">system.run[rm</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> *]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç›‘æ§é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RefreshActiveChecks</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">60</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">BufferSend</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">5</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">BufferSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å¯åŠ¨AgentæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=10050/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. è‡ªå®šä¹‰ç›‘æ§è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/scripts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CPUæ¸©åº¦ç›‘æ§è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/zabbix/scripts/cpu_temp.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è·å–CPUæ¸©åº¦</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TEMP=$(sensors | grep &#39;Core 0&#39; | awk &#39;{print $3}&#39; | sed &#39;s/+//g&#39; | sed &#39;s/Â°C//g&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo $TEMP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/scripts/cpu_temp.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åœ¨zabbix_agent2.confä¸­æ·»åŠ ç”¨æˆ·å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;UserParameter=cpu.temperature,/etc/zabbix/scripts/cpu_temp.sh&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/zabbix/zabbix_agent2.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é‡å¯AgentæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-prometheus-grafanaç›‘æ§ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_1-2-prometheus-grafanaç›‘æ§ç³»ç»Ÿ"><span>1.2 Prometheus + Grafanaç›‘æ§ç³»ç»Ÿ</span></a></h3><h4 id="prometheuså®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#prometheuså®‰è£…é…ç½®"><span>Prometheuså®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. åˆ›å»ºprometheusç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">useradd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --no-create-home</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/prometheus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. ä¸‹è½½å®‰è£…Prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/prometheus/prometheus/releases/download/v2.40.0/prometheus-2.40.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus-2.40.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus-2.40.0.linux-amd64/prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus-2.40.0.linux-amd64/promtool</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/promtool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é…ç½®Prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/prometheus/prometheus.yml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">global:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  scrape_interval: 15s</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  evaluation_interval: 15s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rule_files:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - &quot;rules/*.yml&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">alerting:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  alertmanagers:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    - static_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - targets:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          - localhost:9093</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">scrape_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - job_name: &#39;prometheus&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    static_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - targets: [&#39;localhost:9090&#39;]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - job_name: &#39;node-exporter&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    static_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - targets: </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - &#39;192.168.1.101:9100&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - &#39;192.168.1.102:9100&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - job_name: &#39;mysql-exporter&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    static_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - targets: [&#39;192.168.1.101:9104&#39;]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - job_name: &#39;nginx-exporter&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    static_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - targets: [&#39;192.168.1.101:9113&#39;]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/prometheus/prometheus.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. åˆ›å»ºsystemdæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/systemd/system/prometheus.service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Description=Prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Wants=network-online.target</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">After=network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">User=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Group=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Type=simple</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ExecStart=/usr/local/bin/prometheus \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --config.file /etc/prometheus/prometheus.yml \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --storage.tsdb.path /var/lib/prometheus/ \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.console.templates=/etc/prometheus/consoles \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.console.libraries=/etc/prometheus/console_libraries \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.listen-address=0.0.0.0:9090 \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.enable-lifecycle \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --storage.tsdb.retention.time=30d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 7. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=9090/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="node-exporterå®‰è£…" tabindex="-1"><a class="header-anchor" href="#node-exporterå®‰è£…"><span>Node Exporterå®‰è£…ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. ä¸‹è½½å®‰è£…Node Exporter</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/prometheus/node_exporter/releases/download/v1.5.0/node_exporter-1.5.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter-1.5.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter-1.5.0.linux-amd64/node_exporter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/node_exporter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. åˆ›å»ºsystemdæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/systemd/system/node_exporter.service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Description=Node Exporter</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Wants=network-online.target</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">After=network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">User=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Group=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Type=simple</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ExecStart=/usr/local/bin/node_exporter \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --collector.systemd \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --collector.processes \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.listen-address=0.0.0.0:9100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=9100/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="grafanaå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#grafanaå®‰è£…é…ç½®"><span>Grafanaå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. æ·»åŠ Grafanaä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/yum.repos.d/grafana.repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[grafana]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">name=grafana</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">baseurl=https://packages.grafana.com/oss/rpm</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">repo_gpgcheck=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">enabled=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgcheck=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgkey=https://packages.grafana.com/gpg.key</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sslverify=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sslcacert=/etc/pki/tls/certs/ca-bundle.crt</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. å®‰è£…Grafana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grafana</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. é…ç½®Grafana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/grafana/grafana.ini</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[server]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http_addr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">domain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root_url</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:3000/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[database]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sqlite3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 127.0.0.1:3306</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grafana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[security]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">admin_user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> admin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">admin_password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Grafana@123!</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">secret_key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SW2YcwTIb9zpOOhoPsMm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grafana-server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grafana-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=3000/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6. é…ç½®æ•°æ®æºï¼ˆé€šè¿‡Webç•Œé¢ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¿é—® http://server_ip:3000</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ·»åŠ Prometheusæ•°æ®æºï¼šhttp://localhost:9090</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-ç›‘æ§å‘Šè­¦é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-3-ç›‘æ§å‘Šè­¦é…ç½®"><span>1.3 ç›‘æ§å‘Šè­¦é…ç½®</span></a></h3><h4 id="alertmanageré…ç½®" tabindex="-1"><a class="header-anchor" href="#alertmanageré…ç½®"><span>Alertmanageré…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. ä¸‹è½½å®‰è£…Alertmanager</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/prometheus/alertmanager/releases/download/v0.25.0/alertmanager-0.25.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertmanager-0.25.0.linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertmanager-0.25.0.linux-amd64/alertmanager</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertmanager-0.25.0.linux-amd64/amtool</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/alertmanager</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/amtool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. åˆ›å»ºé…ç½®ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/alertmanager</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/alertmanager</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. é…ç½®Alertmanager</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/alertmanager/alertmanager.yml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">global:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  smtp_smarthost: &#39;smtp.163.com:587&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  smtp_from: &#39;monitor@company.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  smtp_auth_username: &#39;monitor@company.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  smtp_auth_password: &#39;password123&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">route:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  group_by: [&#39;alertname&#39;, &#39;instance&#39;]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  group_wait: 10s</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  group_interval: 10s</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  repeat_interval: 1h</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  receiver: &#39;web.hook&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">receivers:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - name: &#39;web.hook&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    email_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - to: &#39;admin@company.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        subject: &#39;Alert: {{ .GroupLabels.alertname }}&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        body: |</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          {{ range .Alerts }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Alert: {{ .Annotations.summary }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Description: {{ .Annotations.description }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Instance: {{ .Labels.instance }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Severity: {{ .Labels.severity }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          {{ end }}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    webhook_configs:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - url: &#39;http://localhost:8080/webhook&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        send_resolved: true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">inhibit_rules:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - source_match:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      severity: &#39;critical&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    target_match:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      severity: &#39;warning&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    equal: [&#39;alertname&#39;, &#39;instance&#39;]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus:prometheus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/alertmanager/alertmanager.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. åˆ›å»ºsystemdæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/systemd/system/alertmanager.service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Description=Alertmanager</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Wants=network-online.target</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">After=network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">User=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Group=prometheus</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Type=simple</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ExecStart=/usr/local/bin/alertmanager \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --config.file /etc/alertmanager/alertmanager.yml \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --storage.path /var/lib/alertmanager/ \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    --web.listen-address=0.0.0.0:9093</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertmanager</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertmanager</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="prometheuså‘Šè­¦è§„åˆ™é…ç½®" tabindex="-1"><a class="header-anchor" href="#prometheuså‘Šè­¦è§„åˆ™é…ç½®"><span>Prometheuså‘Šè­¦è§„åˆ™é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. åˆ›å»ºè§„åˆ™ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/prometheus/rules</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. ç³»ç»Ÿç›‘æ§è§„åˆ™</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/prometheus/rules/system.yml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">groups:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - name: system.rules</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    rules:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # CPUä½¿ç”¨ç‡è¿‡é«˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighCpuUsage</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=&quot;idle&quot;}[5m])) * 100) &gt; 80</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: warning</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High CPU usage detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;CPU usage is above 80% for more than 5 minutes on {{ $labels.instance }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighMemoryUsage</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 &gt; 85</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: warning</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High memory usage detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;Memory usage is above 85% on {{ $labels.instance }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # ç£ç›˜ç©ºé—´ä¸è¶³</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighDiskUsage</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: (node_filesystem_size_bytes - node_filesystem_avail_bytes) / node_filesystem_size_bytes * 100 &gt; 90</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: critical</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High disk usage detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;Disk usage is above 90% on {{ $labels.instance }} filesystem {{ $labels.mountpoint }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # ç³»ç»Ÿè´Ÿè½½è¿‡é«˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighSystemLoad</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: node_load15 / count by(instance) (node_cpu_seconds_total{mode=&quot;idle&quot;}) &gt; 2</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: warning</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High system load detected&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;System load is above 2.0 on {{ $labels.instance }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # æœåŠ¡å™¨å®•æœº</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: InstanceDown</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: up == 0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 1m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: critical</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;Instance down&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;Instance {{ $labels.instance }} has been down for more than 1 minute&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. åº”ç”¨ç›‘æ§è§„åˆ™</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/prometheus/rules/application.yml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">groups:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  - name: application.rules</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    rules:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # HTTPå“åº”æ—¶é—´è¿‡é•¿</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighHttpResponseTime</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) &gt; 0.5</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: warning</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High HTTP response time&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;95% of HTTP requests take more than 0.5s on {{ $labels.instance }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # HTTPé”™è¯¯ç‡è¿‡é«˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighHttpErrorRate</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: rate(http_requests_total{code=~&quot;5..&quot;}[5m]) / rate(http_requests_total[5m]) * 100 &gt; 5</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: critical</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High HTTP error rate&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;HTTP error rate is above 5% on {{ $labels.instance }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      # æ•°æ®åº“è¿æ¥æ•°è¿‡é«˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      - alert: HighDatabaseConnections</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        expr: mysql_global_status_threads_connected / mysql_global_variables_max_connections * 100 &gt; 80</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        for: 5m</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        labels:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          severity: warning</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        annotations:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          summary: &quot;High database connections&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          description: &quot;Database connections usage is above 80% on {{ $labels.instance }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é‡è½½Prometheusé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -X</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> POST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:9090/-/reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="äºŒã€æ—¥å¿—ç®¡ç†è¯¦ç»†æ“ä½œæŒ‡å—" tabindex="-1"><a class="header-anchor" href="#äºŒã€æ—¥å¿—ç®¡ç†è¯¦ç»†æ“ä½œæŒ‡å—"><span>äºŒã€æ—¥å¿—ç®¡ç†è¯¦ç»†æ“ä½œæŒ‡å—</span></a></h2><h3 id="_2-1-elk-stackéƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#_2-1-elk-stackéƒ¨ç½²"><span>2.1 ELK Stackéƒ¨ç½²</span></a></h3><h4 id="elasticsearchå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#elasticsearchå®‰è£…é…ç½®"><span>Elasticsearchå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. å®‰è£…Java</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> java-11-openjdk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> java-11-openjdk-devel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. æ·»åŠ Elasticsearchä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://artifacts.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/yum.repos.d/elasticsearch.repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[elasticsearch]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">name=Elasticsearch repository for 8.x packages</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">baseurl=https://artifacts.elastic.co/packages/8.x/yum</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgcheck=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">enabled=0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">autorefresh=1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">type=rpm-md</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å®‰è£…Elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enablerepo=elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é…ç½®Elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/elasticsearch/elasticsearch.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cluster.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> production-cluster</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">node.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.data:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.logs:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">network.host:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http.port:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 9200</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">discovery.type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> single-node</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®‰å…¨é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.security.enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.security.enrollment.enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.security.http.ssl:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> false</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.security.transport.ssl:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># JVMé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/elasticsearch/jvm.options</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xms2g</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xmx2g</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6. è®¾ç½®å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/share/elasticsearch/bin/elasticsearch-setup-passwords</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> interactive</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 7. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=9200/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="logstashå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#logstashå®‰è£…é…ç½®"><span>Logstashå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. å®‰è£…Logstash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enablerepo=elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logstash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®Logstashç®¡é“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/logstash/conf.d/beats-input.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">input {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  beats {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    port =&gt; 5044</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">filter {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  if [fileset][module] == &quot;system&quot; {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if [fileset][name] == &quot;auth&quot; {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      grok {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        match =&gt; { &quot;message&quot; =&gt; &quot;%{SYSLOGTIMESTAMP:timestamp} %{IPORHOST:server} %{PROG:program}: %{GREEDYDATA:content}&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    else if [fileset][name] == &quot;syslog&quot; {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      grok {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        match =&gt; { &quot;message&quot; =&gt; &quot;%{SYSLOGTIMESTAMP:timestamp} %{IPORHOST:server} %{PROG:program}: %{GREEDYDATA:content}&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  if [fields][log_type] == &quot;nginx_access&quot; {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    grok {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      match =&gt; { &quot;message&quot; =&gt; &quot;%{NGINXACCESS}&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    date {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      match =&gt; [ &quot;timestamp&quot;, &quot;dd/MMM/yyyy:HH:mm:ss Z&quot; ]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    mutate {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      convert =&gt; { &quot;response&quot; =&gt; &quot;integer&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      convert =&gt; { &quot;bytes&quot; =&gt; &quot;integer&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      convert =&gt; { &quot;responsetime&quot; =&gt; &quot;float&quot; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">output {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  elasticsearch {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    hosts =&gt; [&quot;localhost:9200&quot;]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    user =&gt; &quot;elastic&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    password =&gt; &quot;password123&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    index =&gt; &quot;%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. é…ç½®JVM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/logstash/jvm.options</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xms1g</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xmx1g</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logstash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logstash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=5044/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="kibanaå®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#kibanaå®‰è£…é…ç½®"><span>Kibanaå®‰è£…é…ç½®ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. å®‰è£…Kibana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enablerepo=elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kibana</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®Kibana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/kibana/kibana.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server.port:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5601</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server.host:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;0.0.0.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">elasticsearch.hosts:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://localhost:9200&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">elasticsearch.username:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;kibana_system&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">elasticsearch.password:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;password123&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®‰å…¨é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.security.enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xpack.encryptedSavedObjects.encryptionKey:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;fhjskloppd678ehkdfdlliverpoolfcr&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kibana</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kibana</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4. é˜²ç«å¢™é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=5601/tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="filebeaté…ç½®-åœ¨å®¢æˆ·ç«¯æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#filebeaté…ç½®-åœ¨å®¢æˆ·ç«¯æœåŠ¡å™¨"><span>Filebeaté…ç½®ï¼ˆåœ¨å®¢æˆ·ç«¯æœåŠ¡å™¨ï¼‰ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. å®‰è£…Filebeat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --enablerepo=elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filebeat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®Filebeat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/filebeat/filebeat.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">filebeat.inputs:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  paths:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/messages</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/secure</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    log_type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> system</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields_under_root:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  paths:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/nginx/access.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    log_type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx_access</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields_under_root:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  paths:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/nginx/error.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    log_type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx_error</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  fields_under_root:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">output.logstash:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  hosts:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.168.1.100:5044&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">processors:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add_host_metadata:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      when.not.contains.tags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> forwarded</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filebeat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filebeat</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-æ—¥å¿—åˆ†æå’Œå‘Šè­¦" tabindex="-1"><a class="header-anchor" href="#_2-2-æ—¥å¿—åˆ†æå’Œå‘Šè­¦"><span>2.2 æ—¥å¿—åˆ†æå’Œå‘Šè­¦</span></a></h3><h4 id="æ—¥å¿—åˆ†æè„šæœ¬" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—åˆ†æè„šæœ¬"><span>æ—¥å¿—åˆ†æè„šæœ¬ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. ç³»ç»Ÿæ—¥å¿—åˆ†æè„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/log_analyzer.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">LOG_FILE=&quot;/var/log/messages&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ERROR_LOG=&quot;/var/log/log_errors.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date +%Y-%m-%d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># åˆ†æé”™è¯¯æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== ç³»ç»Ÿé”™è¯¯æ—¥å¿—åˆ†æ - $DATE ===&quot; &gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æŸ¥æ‰¾ç£ç›˜é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;ç£ç›˜é”™è¯¯:&quot; &gt;&gt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grep -i &quot;disk\|I/O\|filesystem&quot; $LOG_FILE | tail -20 &gt;&gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æŸ¥æ‰¾å†…å­˜é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nå†…å­˜é”™è¯¯:&quot; &gt;&gt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grep -i &quot;memory\|oom\|killed&quot; $LOG_FILE | tail -20 &gt;&gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æŸ¥æ‰¾ç½‘ç»œé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nç½‘ç»œé”™è¯¯:&quot; &gt;&gt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grep -i &quot;network\|connection\|timeout&quot; $LOG_FILE | tail -20 &gt;&gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æŸ¥æ‰¾SSHç™»å½•å¤±è´¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nSSHç™»å½•å¤±è´¥:&quot; &gt;&gt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grep &quot;Failed password&quot; /var/log/secure | tail -20 &gt;&gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç»Ÿè®¡é”™è¯¯é¢‘ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\né”™è¯¯ç»Ÿè®¡:&quot; &gt;&gt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grep -i &quot;error\|fail\|critical&quot; $LOG_FILE | awk &#39;{print $5}&#39; | sort | uniq -c | sort -nr &gt;&gt; $ERROR_LOG</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å‘é€é‚®ä»¶å‘Šè­¦</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if [ -s $ERROR_LOG ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    mail -s &quot;ç³»ç»Ÿé”™è¯¯æ—¥å¿—æŠ¥å‘Š - $DATE&quot; admin@company.com &lt; $ERROR_LOG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/log_analyzer.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®å®šæ—¶ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;0 1 * * * /usr/local/bin/log_analyzer.sh&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crontab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. Webè®¿é—®æ—¥å¿—åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/web_log_analyzer.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NGINX_LOG=&quot;/var/log/nginx/access.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">REPORT_FILE=&quot;/tmp/web_access_report.txt&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date +%Y-%m-%d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== Webè®¿é—®æ—¥å¿—åˆ†æ - $DATE ===&quot; &gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è®¿é—®é‡ç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ€»è®¿é—®é‡:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">wc -l $NGINX_LOG &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># IPè®¿é—®æ’å</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nè®¿é—®IPæ’åï¼ˆå‰10ï¼‰:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">awk &#39;{print $1}&#39; $NGINX_LOG | sort | uniq -c | sort -nr | head -10 &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># é¡µé¢è®¿é—®æ’å</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\né¡µé¢è®¿é—®æ’åï¼ˆå‰10ï¼‰:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">awk &#39;{print $7}&#39; $NGINX_LOG | sort | uniq -c | sort -nr | head -10 &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># çŠ¶æ€ç ç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nçŠ¶æ€ç ç»Ÿè®¡:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">awk &#39;{print $9}&#39; $NGINX_LOG | sort | uniq -c | sort -nr &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 404é”™è¯¯é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n404é”™è¯¯é¡µé¢ï¼ˆå‰10ï¼‰:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">awk &#39;$9==404 {print $7}&#39; $NGINX_LOG | sort | uniq -c | sort -nr | head -10 &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å¼‚å¸¸IPæ£€æµ‹ï¼ˆè®¿é—®é‡è¶…è¿‡1000çš„IPï¼‰</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nå¼‚å¸¸è®¿é—®IP:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">awk &#39;{print $1}&#39; $NGINX_LOG | sort | uniq -c | awk &#39;$1&gt;1000 {print $2 &quot; - &quot; $1 &quot; æ¬¡è®¿é—®&quot;}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cat $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/web_log_analyzer.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ä¸‰ã€æ€§èƒ½ç›‘æ§è¯¦ç»†æ“ä½œæŒ‡å—" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æ€§èƒ½ç›‘æ§è¯¦ç»†æ“ä½œæŒ‡å—"><span>ä¸‰ã€æ€§èƒ½ç›‘æ§è¯¦ç»†æ“ä½œæŒ‡å—</span></a></h2><h3 id="_3-1-ç³»ç»Ÿæ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_3-1-ç³»ç»Ÿæ€§èƒ½ç›‘æ§"><span>3.1 ç³»ç»Ÿæ€§èƒ½ç›‘æ§</span></a></h3><h4 id="ç³»ç»Ÿæ€§èƒ½ç›‘æ§è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿæ€§èƒ½ç›‘æ§è„šæœ¬"><span>ç³»ç»Ÿæ€§èƒ½ç›‘æ§è„šæœ¬ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. ç»¼åˆæ€§èƒ½ç›‘æ§è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/performance_monitor.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">HOSTNAME=$(hostname)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">LOG_FILE=&quot;/var/log/performance.log&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== ç³»ç»Ÿæ€§èƒ½æŠ¥å‘Š - $HOSTNAME - $DATE ===&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># CPUä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### CPUä½¿ç”¨ç‡ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">top -bn1 | grep &quot;Cpu(s)&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;CPUè´Ÿè½½:&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uptime | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å†…å­˜ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### å†…å­˜ä½¿ç”¨æƒ…å†µ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">free -h | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å†…å­˜ä½¿ç”¨ç‡:&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">free | awk &#39;NR==2{printf &quot;%.2f%%\n&quot;, $3*100/$2}&#39; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç£ç›˜ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ç£ç›˜ä½¿ç”¨æƒ…å†µ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">df -h | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç½‘ç»œè¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ç½‘ç»œè¿æ¥ç»Ÿè®¡ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ss -s | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è¿›ç¨‹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### å ç”¨èµ„æºæœ€å¤šçš„è¿›ç¨‹ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;CPUå ç”¨å‰5:&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ps aux --sort=-%cpu | head -6 | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å†…å­˜å ç”¨å‰5:&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ps aux --sort=-%mem | head -6 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># I/Oç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ç£ç›˜I/Oç»Ÿè®¡ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">iostat -x 1 1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ£€æŸ¥å‘Šè­¦æ¡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">check_alerts() {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    # CPUä½¿ç”¨ç‡æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    CPU_USAGE=$(top -bn1 | grep &quot;Cpu(s)&quot; | awk &#39;{print $2}&#39; | awk -F&#39;%&#39; &#39;{print $1}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if (( $(echo &quot;$CPU_USAGE &gt; 80&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ALERT: CPUä½¿ç”¨ç‡è¶…è¿‡80%: $CPU_USAGE%&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;CPUä½¿ç”¨ç‡å‘Šè­¦: $CPU_USAGE%&quot; | mail -s &quot;CPUå‘Šè­¦ - $HOSTNAME&quot; admin@company.com</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    # å†…å­˜ä½¿ç”¨ç‡æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    MEM_USAGE=$(free | awk &#39;NR==2{printf &quot;%.2f&quot;, $3*100/$2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if (( $(echo &quot;$MEM_USAGE &gt; 85&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ALERT: å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡85%: $MEM_USAGE%&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦: $MEM_USAGE%&quot; | mail -s &quot;å†…å­˜å‘Šè­¦ - $HOSTNAME&quot; admin@company.com</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    # ç£ç›˜ä½¿ç”¨ç‡æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    DISK_USAGE=$(df -h | awk &#39;$NF==&quot;/&quot;{printf &quot;%d&quot;, $5}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if [ $DISK_USAGE -gt 90 ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ALERT: æ ¹åˆ†åŒºä½¿ç”¨ç‡è¶…è¿‡90%: $DISK_USAGE%&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ç£ç›˜ç©ºé—´å‘Šè­¦: $DISK_USAGE%&quot; | mail -s &quot;ç£ç›˜å‘Šè­¦ - $HOSTNAME&quot; admin@company.com</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">check_alerts</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;======================================&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/performance_monitor.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆæ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;*/5 * * * * /usr/local/bin/performance_monitor.sh&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crontab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-æ•°æ®åº“æ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#_3-2-æ•°æ®åº“æ€§èƒ½ç›‘æ§"><span>3.2 æ•°æ®åº“æ€§èƒ½ç›‘æ§</span></a></h3><h4 id="mysqlæ€§èƒ½ç›‘æ§" tabindex="-1"><a class="header-anchor" href="#mysqlæ€§èƒ½ç›‘æ§"><span>MySQLæ€§èƒ½ç›‘æ§ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. MySQLæ€§èƒ½ç›‘æ§è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/mysql_monitor.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_USER=&quot;monitor&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_PASS=&quot;Monitor@123&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_HOST=&quot;localhost&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">LOG_FILE=&quot;/var/log/mysql_performance.log&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== MySQLæ€§èƒ½ç›‘æ§ - $DATE ===&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è¿æ¥æ•°ç›‘æ§</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### è¿æ¥çŠ¶æ€ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Threads_connected&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Threads_running&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Max_used_connections&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW VARIABLES LIKE &#39;max_connections&#39;;&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æŸ¥è¯¢ç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### æŸ¥è¯¢ç»Ÿè®¡ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Queries&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Questions&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Slow_queries&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Com_select&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Com_insert&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Com_update&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Com_delete&#39;;&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># InnoDBçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### InnoDBçŠ¶æ€ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Innodb_buffer_pool_read_requests&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Innodb_buffer_pool_reads&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Innodb_buffer_pool_pages_total&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Innodb_buffer_pool_pages_free&#39;;&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># é”çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### é”çŠ¶æ€ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Table_locks_waited&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SHOW STATUS LIKE &#39;Table_locks_immediate&#39;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SELECT * FROM information_schema.INNODB_LOCKS;&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ…¢æŸ¥è¯¢æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŸ¥è¯¢ ###&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SELECT ID, USER, HOST, DB, COMMAND, TIME, STATE, INFO </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">FROM information_schema.PROCESSLIST </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">WHERE COMMAND != &#39;Sleep&#39; AND TIME &gt; 5 </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ORDER BY TIME DESC;&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å‘Šè­¦æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">check_mysql_alerts() {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    # è¿æ¥æ•°æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    CONNECTIONS=$(mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;SHOW STATUS LIKE &#39;Threads_connected&#39;;&quot; | awk &#39;NR==2 {print $2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    MAX_CONNECTIONS=$(mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;SHOW VARIABLES LIKE &#39;max_connections&#39;;&quot; | awk &#39;NR==2 {print $2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    CONNECTION_USAGE=$(echo &quot;scale=2; $CONNECTIONS * 100 / $MAX_CONNECTIONS&quot; | bc)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if (( $(echo &quot;$CONNECTION_USAGE &gt; 80&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ALERT: MySQLè¿æ¥æ•°ä½¿ç”¨ç‡è¶…è¿‡80%: $CONNECTION_USAGE%&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;MySQLè¿æ¥æ•°å‘Šè­¦: $CONNECTION_USAGE%&quot; | mail -s &quot;MySQLè¿æ¥æ•°å‘Šè­¦&quot; admin@company.com</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    # æ…¢æŸ¥è¯¢æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    SLOW_QUERIES=$(mysql -u$MYSQL_USER -p$MYSQL_PASS -h$MYSQL_HOST -e &quot;SHOW STATUS LIKE &#39;Slow_queries&#39;;&quot; | awk &#39;NR==2 {print $2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if [ $SLOW_QUERIES -gt 100 ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        echo &quot;ALERT: æ…¢æŸ¥è¯¢æ•°é‡è¿‡å¤š: $SLOW_QUERIES&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">check_mysql_alerts</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;======================================&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/mysql_monitor.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. é…ç½®å®šæ—¶ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;*/10 * * * * /usr/local/bin/mysql_monitor.sh&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crontab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="å››ã€æˆæœ¬ä¼˜åŒ–è¯¦ç»†æ“ä½œæŒ‡å—" tabindex="-1"><a class="header-anchor" href="#å››ã€æˆæœ¬ä¼˜åŒ–è¯¦ç»†æ“ä½œæŒ‡å—"><span>å››ã€æˆæœ¬ä¼˜åŒ–è¯¦ç»†æ“ä½œæŒ‡å—</span></a></h2><h3 id="_4-1-èµ„æºä½¿ç”¨åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-1-èµ„æºä½¿ç”¨åˆ†æ"><span>4.1 èµ„æºä½¿ç”¨åˆ†æ</span></a></h3><h4 id="æœåŠ¡å™¨èµ„æºåˆ†æè„šæœ¬" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡å™¨èµ„æºåˆ†æè„šæœ¬"><span>æœåŠ¡å™¨èµ„æºåˆ†æè„šæœ¬ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. èµ„æºä½¿ç”¨åˆ†æè„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/resource_analyzer.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">HOSTNAME=$(hostname)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">REPORT_FILE=&quot;/tmp/resource_report_$(date +%Y%m%d).txt&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== æœåŠ¡å™¨èµ„æºä½¿ç”¨åˆ†ææŠ¥å‘Š - $HOSTNAME - $DATE ===&quot; &gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># CPUåˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### CPUä½¿ç”¨åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;CPUæ ¸å¿ƒæ•°: $(nproc)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;CPUå‹å·: $(lscpu | grep &#39;Model name&#39; | awk -F: &#39;{print $2}&#39; | xargs)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è¿‡å»24å°æ—¶å¹³å‡CPUä½¿ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;è¿‡å»24å°æ—¶å¹³å‡CPUä½¿ç”¨ç‡:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sar -u 1 1 | tail -1 | awk &#39;{printf &quot;ç”¨æˆ·: %.2f%%, ç³»ç»Ÿ: %.2f%%, ç©ºé—²: %.2f%%\n&quot;, $3, $5, $8}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å†…å­˜åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### å†…å­˜ä½¿ç”¨åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ€»å†…å­˜: $(free -h | awk &#39;NR==2{print $2}&#39;)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å·²ä½¿ç”¨: $(free -h | awk &#39;NR==2{print $3}&#39;)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å¯ç”¨å†…å­˜: $(free -h | awk &#39;NR==2{print $7}&#39;)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;ä½¿ç”¨ç‡: $(free | awk &#39;NR==2{printf &quot;%.2f%%\n&quot;, $3*100/$2}&#39;)&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å†…å­˜å ç”¨å‰10è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nå†…å­˜å ç”¨å‰10è¿›ç¨‹:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ps aux --sort=-%mem | head -11 | awk &#39;{printf &quot;%-10s %-8s %-8s %s\n&quot;, $1, $4&quot;%&quot;, $6/1024&quot;MB&quot;, $11}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç£ç›˜åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ç£ç›˜ä½¿ç”¨åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">df -h &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å¤§æ–‡ä»¶æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nå¤§æ–‡ä»¶æ£€æŸ¥ï¼ˆ&gt;100MBï¼‰:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">find / -type f -size +100M -exec ls -lh {} \; 2&gt;/dev/null | head -10 &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç½‘ç»œä½¿ç”¨åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ç½‘ç»œä½¿ç”¨åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;ç½‘ç»œæ¥å£:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ip addr show | grep -E &#39;^[0-9]+:&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æœåŠ¡åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### è¿è¡ŒæœåŠ¡åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">systemctl list-units --type=service --state=running | wc -l | awk &#39;{print &quot;è¿è¡Œä¸­çš„æœåŠ¡æ•°é‡: &quot; $1}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ä¼˜åŒ–å»ºè®® ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># CPUä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">CPU_IDLE=$(sar -u 1 1 | tail -1 | awk &#39;{print $8}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if (( $(echo &quot;$CPU_IDLE &lt; 20&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- CPUä½¿ç”¨ç‡è¿‡é«˜ï¼Œå»ºè®®å‡çº§CPUæˆ–ä¼˜åŒ–åº”ç”¨ç¨‹åº&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">elif (( $(echo &quot;$CPU_IDLE &gt; 80&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- CPUèµ„æºå……è£•ï¼Œå¯è€ƒè™‘é™ä½é…ç½®æˆ–éƒ¨ç½²æ›´å¤šåº”ç”¨&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å†…å­˜ä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MEM_USAGE=$(free | awk &#39;NR==2{printf &quot;%.2f&quot;, $3*100/$2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if (( $(echo &quot;$MEM_USAGE &gt; 85&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ï¼Œå»ºè®®å¢åŠ å†…å­˜æˆ–ä¼˜åŒ–åº”ç”¨&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">elif (( $(echo &quot;$MEM_USAGE &lt; 30&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- å†…å­˜ä½¿ç”¨ç‡è¾ƒä½ï¼Œå¯è€ƒè™‘é™ä½å†…å­˜é…ç½®&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç£ç›˜ä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DISK_USAGE=$(df -h / | awk &#39;NR==2 {print $5}&#39; | sed &#39;s/%//&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if [ $DISK_USAGE -gt 85 ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œå»ºè®®æ¸…ç†æˆ–æ‰©å®¹&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">elif [ $DISK_USAGE -lt 30 ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- ç£ç›˜ä½¿ç”¨ç‡è¾ƒä½ï¼Œé…ç½®å¯èƒ½è¿‡å¤§&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\næŠ¥å‘Šç”Ÿæˆæ—¶é—´: $DATE&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cat $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/resource_analyzer.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. è‡ªåŠ¨æ¸…ç†è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/auto_cleanup.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">LOG_FILE=&quot;/var/log/cleanup.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== è‡ªåŠ¨æ¸…ç†ä»»åŠ¡å¼€å§‹ - $DATE ===&quot; | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ¸…ç†ç³»ç»Ÿæ—¥å¿—ï¼ˆä¿ç•™30å¤©ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†ç³»ç»Ÿæ—¥å¿—...&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">journalctl --vacuum-time=30d 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ¸…ç†æ—§çš„æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶...&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">find /var/log -name &quot;*.log.*&quot; -mtime +30 -delete 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">find /var/log -name &quot;*.gz&quot; -mtime +30 -delete 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†ä¸´æ—¶æ–‡ä»¶...&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">find /tmp -type f -mtime +7 -delete 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">find /var/tmp -type f -mtime +7 -delete 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ¸…ç†åŒ…ç¼“å­˜</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†åŒ…ç¼“å­˜...&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dnf clean all 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ¸…ç†å†…æ ¸æ—§ç‰ˆæœ¬ï¼ˆä¿ç•™æœ€æ–°3ä¸ªç‰ˆæœ¬ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†æ—§å†…æ ¸ç‰ˆæœ¬...&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dnf remove $(dnf repoquery --installonly --latest-limit=-3 -q) -y 2&gt;&amp;1 | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç»Ÿè®¡æ¸…ç†æ•ˆæœ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;æ¸…ç†å®Œæˆç»Ÿè®¡:&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">df -h / | tee -a $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== è‡ªåŠ¨æ¸…ç†ä»»åŠ¡å®Œæˆ - $(date &#39;+%Y-%m-%d %H:%M:%S&#39;) ===&quot; | tee -a $LOG_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/auto_cleanup.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3. é…ç½®å®šæ—¶æ¸…ç†ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;0 2 * * 0 /usr/local/bin/auto_cleanup.sh&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crontab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-äº‘æœåŠ¡æˆæœ¬ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_4-2-äº‘æœåŠ¡æˆæœ¬ä¼˜åŒ–"><span>4.2 äº‘æœåŠ¡æˆæœ¬ä¼˜åŒ–</span></a></h3><h4 id="é˜¿é‡Œäº‘æˆæœ¬åˆ†æè„šæœ¬" tabindex="-1"><a class="header-anchor" href="#é˜¿é‡Œäº‘æˆæœ¬åˆ†æè„šæœ¬"><span>é˜¿é‡Œäº‘æˆæœ¬åˆ†æè„šæœ¬ï¼š</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. é˜¿é‡Œäº‘æˆæœ¬åˆ†æè„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/aliyun_cost_analyzer.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># é…ç½®é˜¿é‡Œäº‘CLI</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">REGION=&quot;cn-hangzhou&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">REPORT_FILE=&quot;/tmp/aliyun_cost_report_$(date +%Y%m%d).txt&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== é˜¿é‡Œäº‘èµ„æºæˆæœ¬åˆ†ææŠ¥å‘Š - $DATE ===&quot; &gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ECSå®ä¾‹åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### ECSå®ä¾‹åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aliyun ecs DescribeInstances --RegionId $REGION | jq -r &#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.Instances.Instance[] | </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å®ä¾‹ID: \(.InstanceId), è§„æ ¼: \(.InstanceType), çŠ¶æ€: \(.Status), åˆ›å»ºæ—¶é—´: \(.CreationTime)&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è·å–ECSå®ä¾‹æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ECS_COUNT=$(aliyun ecs DescribeInstances --RegionId $REGION | jq &#39;.Instances.Instance | length&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;ECSå®ä¾‹æ€»æ•°: $ECS_COUNT&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># RDSå®ä¾‹åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### RDSå®ä¾‹åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aliyun rds DescribeDBInstances --RegionId $REGION | jq -r &#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.Items.DBInstance[] | </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å®ä¾‹ID: \(.DBInstanceId), è§„æ ¼: \(.DBInstanceClass), çŠ¶æ€: \(.DBInstanceStatus), å­˜å‚¨: \(.DBInstanceStorage)GB&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># SLBå®ä¾‹åˆ†æ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### è´Ÿè½½å‡è¡¡å®ä¾‹åˆ†æ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">aliyun slb DescribeLoadBalancers --RegionId $REGION | jq -r &#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.LoadBalancers.LoadBalancer[] | </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å®ä¾‹ID: \(.LoadBalancerId), ç±»å‹: \(.LoadBalancerSpec), çŠ¶æ€: \(.LoadBalancerStatus)&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### æˆæœ¬ä¼˜åŒ–å»ºè®® ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ£€æŸ¥åœæ­¢çš„ECSå®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">STOPPED_ECS=$(aliyun ecs DescribeInstances --RegionId $REGION | jq &#39;.Instances.Instance[] | select(.Status==&quot;Stopped&quot;) | .InstanceId&#39; | wc -l)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if [ $STOPPED_ECS -gt 0 ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- å‘ç° $STOPPED_ECS å°åœæ­¢çš„ECSå®ä¾‹ï¼Œå»ºè®®é‡Šæ”¾æˆ–è½¬æ¢ä¸ºæŒ‰é‡ä»˜è´¹&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ£€æŸ¥ä½ä½¿ç”¨ç‡å®ä¾‹ï¼ˆéœ€è¦é…åˆç›‘æ§æ•°æ®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;- å»ºè®®å®šæœŸæ£€æŸ¥å®ä¾‹CPUã€å†…å­˜ä½¿ç”¨ç‡ï¼Œä¼˜åŒ–é…ç½®&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;- è€ƒè™‘ä½¿ç”¨é¢„ç•™å®ä¾‹æˆ–åŒ…å¹´åŒ…æœˆè·å¾—æŠ˜æ‰£&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;- è¯„ä¼°æ˜¯å¦å¯ä»¥ä½¿ç”¨ç«ä»·å®ä¾‹é™ä½æˆæœ¬&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;- è®¾ç½®è´¹ç”¨é¢„ç®—å’Œå‘Šè­¦ï¼Œé¿å…æ„å¤–è¶…æ”¯&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cat $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/aliyun_cost_analyzer.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. èµ„æºåˆ©ç”¨ç‡ç›‘æ§è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/local/bin/resource_utilization.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;EOF&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">REPORT_FILE=&quot;/tmp/utilization_report_$(date +%Y%m%d).txt&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DATE=$(date &#39;+%Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;=== èµ„æºåˆ©ç”¨ç‡æŠ¥å‘Š - $DATE ===&quot; &gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># è¿‡å»24å°æ—¶çš„å¹³å‡åˆ©ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### è¿‡å»24å°æ—¶èµ„æºåˆ©ç”¨ç‡ ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># CPUåˆ©ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">CPU_AVG=$(sar -u -s $(date -d &#39;1 day ago&#39; &#39;+%H:%M:%S&#39;) | grep Average | awk &#39;{print 100-$8}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å¹³å‡CPUåˆ©ç”¨ç‡: ${CPU_AVG}%&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># å†…å­˜åˆ©ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MEM_TOTAL=$(free -b | awk &#39;NR==2{print $2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MEM_USED=$(free -b | awk &#39;NR==2{print $3}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MEM_USAGE=$(echo &quot;scale=2; $MEM_USED * 100 / $MEM_TOTAL&quot; | bc)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo &quot;å½“å‰å†…å­˜åˆ©ç”¨ç‡: ${MEM_USAGE}%&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç£ç›˜åˆ©ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nç£ç›˜åˆ©ç”¨ç‡:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">df -h | awk &#39;NR&gt;1 {print $6 &quot;: &quot; $5}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># ç½‘ç»œåˆ©ç”¨ç‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\nç½‘ç»œç»Ÿè®¡:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cat /proc/net/dev | awk &#39;NR&gt;2 {printf &quot;æ¥å£%s: æ¥æ”¶%sMB, å‘é€%sMB\n&quot;, $1, $2/1024/1024, $10/1024/1024}&#39; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># èµ„æºä¼˜åŒ–å»ºè®®</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\n### èµ„æºä¼˜åŒ–å»ºè®® ###&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if (( $(echo &quot;$CPU_AVG &lt; 20&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- CPUåˆ©ç”¨ç‡è¾ƒä½(${CPU_AVG}%)ï¼Œè€ƒè™‘é™ä½é…ç½®æˆ–æ•´åˆæœåŠ¡&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">if (( $(echo &quot;$MEM_USAGE &lt; 30&quot; | bc -l) )); then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo &quot;- å†…å­˜åˆ©ç”¨ç‡è¾ƒä½(${MEM_USAGE}%)ï¼Œè€ƒè™‘å‡å°‘å†…å­˜é…ç½®&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># æ£€æŸ¥æ˜¯å¦æœ‰é•¿æœŸè¿è¡Œä½†CPUä½¿ç”¨ç‡å¾ˆä½çš„è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">echo -e &quot;\né•¿æœŸè¿è¡Œçš„ä½CPUè¿›ç¨‹:&quot; &gt;&gt; $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ps -eo pid,ppid,cmd,%cpu,time --sort=-%cpu | awk &#39;$4&lt;1.0 &amp;&amp; $5&gt;&quot;01:00:00&quot; {print}&#39; | head -10 &gt;&gt; $REPORT_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cat $REPORT_FILE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/resource_utilization.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="é¢è¯•é‡ç‚¹é—®é¢˜è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é‡ç‚¹é—®é¢˜è¯¦è§£"><span>é¢è¯•é‡ç‚¹é—®é¢˜è¯¦è§£</span></a></h2><h3 id="q1-å¦‚ä½•è®¾è®¡ä¸€å¥—å®Œæ•´çš„ç›‘æ§ä½“ç³»" tabindex="-1"><a class="header-anchor" href="#q1-å¦‚ä½•è®¾è®¡ä¸€å¥—å®Œæ•´çš„ç›‘æ§ä½“ç³»"><span>Q1: å¦‚ä½•è®¾è®¡ä¸€å¥—å®Œæ•´çš„ç›‘æ§ä½“ç³»ï¼Ÿ</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>A: ç›‘æ§ä½“ç³»è®¾è®¡è¦ç‚¹ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. ç›‘æ§å±‚æ¬¡è®¾è®¡ï¼š</span></span>
<span class="line"><span>   - åŸºç¡€è®¾æ–½ç›‘æ§ï¼šç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€ç½‘ç»œ</span></span>
<span class="line"><span>   - åº”ç”¨å±‚ç›‘æ§ï¼šä¸­é—´ä»¶ã€æ•°æ®åº“ã€åº”ç”¨æœåŠ¡</span></span>
<span class="line"><span>   - ä¸šåŠ¡ç›‘æ§ï¼šå…³é”®ä¸šåŠ¡æŒ‡æ ‡ã€ç”¨æˆ·ä½“éªŒ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. ç›‘æ§å·¥å…·é€‰æ‹©ï¼š</span></span>
<span class="line"><span>   - ç³»ç»Ÿç›‘æ§ï¼šZabbix/Prometheus + Grafana</span></span>
<span class="line"><span>   - æ—¥å¿—ç›‘æ§ï¼šELK Stack/EFK Stack</span></span>
<span class="line"><span>   - APMç›‘æ§ï¼šSkyWalking/Pinpoint</span></span>
<span class="line"><span>   - ä¸šåŠ¡ç›‘æ§ï¼šè‡ªå®šä¹‰æŒ‡æ ‡æ”¶é›†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. å‘Šè­¦ç­–ç•¥ï¼š</span></span>
<span class="line"><span>   - åˆ†çº§å‘Šè­¦ï¼šCritical/Warning/Info</span></span>
<span class="line"><span>   - å‘Šè­¦æ”¶æ•›ï¼šé¿å…å‘Šè­¦é£æš´</span></span>
<span class="line"><span>   - é€šçŸ¥æ¸ é“ï¼šé‚®ä»¶/çŸ­ä¿¡/å¾®ä¿¡/é’‰é’‰</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. ç›‘æ§è¦†ç›–èŒƒå›´ï¼š</span></span>
<span class="line"><span>   - å¯ç”¨æ€§ç›‘æ§ï¼šæœåŠ¡å¥åº·æ£€æŸ¥</span></span>
<span class="line"><span>   - æ€§èƒ½ç›‘æ§ï¼šå“åº”æ—¶é—´ã€ååé‡</span></span>
<span class="line"><span>   - èµ„æºç›‘æ§ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ</span></span>
<span class="line"><span>   - å®‰å…¨ç›‘æ§ï¼šç™»å½•å¼‚å¸¸ã€æƒé™å˜æ›´</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="q2-å¦‚ä½•å¤„ç†ç›‘æ§ç³»ç»Ÿçš„æµ·é‡æ•°æ®" tabindex="-1"><a class="header-anchor" href="#q2-å¦‚ä½•å¤„ç†ç›‘æ§ç³»ç»Ÿçš„æµ·é‡æ•°æ®"><span>Q2: å¦‚ä½•å¤„ç†ç›‘æ§ç³»ç»Ÿçš„æµ·é‡æ•°æ®ï¼Ÿ</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>A: æµ·é‡ç›‘æ§æ•°æ®å¤„ç†ç­–ç•¥ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. æ•°æ®æ”¶é›†ä¼˜åŒ–ï¼š</span></span>
<span class="line"><span>   - é‡‡æ ·ç­–ç•¥ï¼šå…³é”®æŒ‡æ ‡é«˜é¢‘é‡‡é›†ï¼Œæ™®é€šæŒ‡æ ‡ä½é¢‘é‡‡é›†</span></span>
<span class="line"><span>   - æ•°æ®å‹ç¼©ï¼šä½¿ç”¨é«˜æ•ˆçš„æ•°æ®æ ¼å¼å’Œå‹ç¼©ç®—æ³•</span></span>
<span class="line"><span>   - æœ¬åœ°ç¼“å­˜ï¼šAgentç«¯æœ¬åœ°ç¼“å­˜ï¼Œæ‰¹é‡å‘é€</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. æ•°æ®å­˜å‚¨ä¼˜åŒ–ï¼š</span></span>
<span class="line"><span>   - æ—¶åºæ•°æ®åº“ï¼šInfluxDBã€TimescaleDB</span></span>
<span class="line"><span>   - æ•°æ®åˆ†å±‚å­˜å‚¨ï¼šçƒ­æ•°æ®SSDï¼Œå†·æ•°æ®HDD</span></span>
<span class="line"><span>   - æ•°æ®ç”Ÿå‘½å‘¨æœŸï¼šè‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. æ•°æ®æŸ¥è¯¢ä¼˜åŒ–ï¼š</span></span>
<span class="line"><span>   - ç´¢å¼•ä¼˜åŒ–ï¼šåˆç†è®¾è®¡æ—¶é—´åºåˆ—ç´¢å¼•</span></span>
<span class="line"><span>   - é¢„èšåˆï¼šé¢„è®¡ç®—å¸¸ç”¨æŸ¥è¯¢ç»“æœ</span></span>
<span class="line"><span>   - ç¼“å­˜ç­–ç•¥ï¼šæŸ¥è¯¢ç»“æœç¼“å­˜</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. æ¶æ„æ‰©å±•ï¼š</span></span>
<span class="line"><span>   - æ°´å¹³æ‰©å±•ï¼šå¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²</span></span>
<span class="line"><span>   - è¯»å†™åˆ†ç¦»ï¼šåˆ†ç¦»æŸ¥è¯¢å’Œå†™å…¥è´Ÿè½½</span></span>
<span class="line"><span>   - è´Ÿè½½å‡è¡¡ï¼šåˆ†å¸ƒå¼å­˜å‚¨å’ŒæŸ¥è¯¢</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="q3-å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„æˆæœ¬ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#q3-å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„æˆæœ¬ä¼˜åŒ–"><span>Q3: å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„æˆæœ¬ä¼˜åŒ–ï¼Ÿ</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>A: æˆæœ¬ä¼˜åŒ–ç­–ç•¥ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. èµ„æºä½¿ç”¨åˆ†æï¼š</span></span>
<span class="line"><span>   - å®šæœŸèµ„æºä½¿ç”¨ç‡æŠ¥å‘Š</span></span>
<span class="line"><span>   - è¯†åˆ«ä½ä½¿ç”¨ç‡èµ„æº</span></span>
<span class="line"><span>   - åˆ†æèµ„æºä½¿ç”¨è¶‹åŠ¿</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. æŠ€æœ¯ä¼˜åŒ–ï¼š</span></span>
<span class="line"><span>   - æœåŠ¡å™¨æ•´åˆï¼šè™šæ‹ŸåŒ–æŠ€æœ¯</span></span>
<span class="line"><span>   - è‡ªåŠ¨åŒ–è¿ç»´ï¼šå‡å°‘äººå·¥æˆæœ¬</span></span>
<span class="line"><span>   - æ€§èƒ½è°ƒä¼˜ï¼šæé«˜èµ„æºåˆ©ç”¨ç‡</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. é‡‡è´­ç­–ç•¥ä¼˜åŒ–ï¼š</span></span>
<span class="line"><span>   - é¢„ç•™å®ä¾‹ï¼šé•¿æœŸç¨³å®šä¸šåŠ¡</span></span>
<span class="line"><span>   - ç«ä»·å®ä¾‹ï¼šéå…³é”®ä¸šåŠ¡</span></span>
<span class="line"><span>   - åŒ…å¹´åŒ…æœˆï¼šè·å¾—æŠ˜æ‰£ä¼˜æƒ </span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. ç›‘æ§å’Œæ§åˆ¶ï¼š</span></span>
<span class="line"><span>   - æˆæœ¬ç›‘æ§å·¥å…·ï¼šå®æ—¶è´¹ç”¨è·Ÿè¸ª</span></span>
<span class="line"><span>   - é¢„ç®—æ§åˆ¶ï¼šè®¾ç½®è´¹ç”¨é¢„è­¦</span></span>
<span class="line"><span>   - å®šæœŸå®¡æŸ¥ï¼šæœˆåº¦æˆæœ¬åˆ†æ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="q4-å¦‚ä½•è®¾è®¡æ—¥å¿—ç®¡ç†ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#q4-å¦‚ä½•è®¾è®¡æ—¥å¿—ç®¡ç†ç­–ç•¥"><span>Q4: å¦‚ä½•è®¾è®¡æ—¥å¿—ç®¡ç†ç­–ç•¥ï¼Ÿ</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>A: æ—¥å¿—ç®¡ç†ç­–ç•¥è®¾è®¡ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. æ—¥å¿—åˆ†ç±»ï¼š</span></span>
<span class="line"><span>   - ç³»ç»Ÿæ—¥å¿—ï¼šæ“ä½œç³»ç»Ÿã€ç¡¬ä»¶æ—¥å¿—</span></span>
<span class="line"><span>   - åº”ç”¨æ—¥å¿—ï¼šåº”ç”¨ç¨‹åºè¿è¡Œæ—¥å¿—</span></span>
<span class="line"><span>   - è®¿é—®æ—¥å¿—ï¼šWebæœåŠ¡å™¨è®¿é—®è®°å½•</span></span>
<span class="line"><span>   - å®‰å…¨æ—¥å¿—ï¼šå®¡è®¡ã€å®‰å…¨äº‹ä»¶æ—¥å¿—</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. æ—¥å¿—æ”¶é›†ï¼š</span></span>
<span class="line"><span>   - é›†ä¸­æ”¶é›†ï¼šç»Ÿä¸€æ—¥å¿—æ”¶é›†å¹³å°</span></span>
<span class="line"><span>   - å®æ—¶ä¼ è¾“ï¼šå®æ—¶æˆ–è¿‘å®æ—¶ä¼ è¾“</span></span>
<span class="line"><span>   - æ ¼å¼æ ‡å‡†åŒ–ï¼šç»Ÿä¸€æ—¥å¿—æ ¼å¼</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. æ—¥å¿—å­˜å‚¨ï¼š</span></span>
<span class="line"><span>   - åˆ†å±‚å­˜å‚¨ï¼šçƒ­ã€æ¸©ã€å†·æ•°æ®åˆ†å±‚</span></span>
<span class="line"><span>   - å‹ç¼©å­˜å‚¨ï¼šèŠ‚çœå­˜å‚¨ç©ºé—´</span></span>
<span class="line"><span>   - å¤‡ä»½ç­–ç•¥ï¼šå…³é”®æ—¥å¿—å¼‚åœ°å¤‡ä»½</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. æ—¥å¿—åˆ†æï¼š</span></span>
<span class="line"><span>   - å…¨æ–‡æœç´¢ï¼šå¿«é€Ÿå®šä½é—®é¢˜</span></span>
<span class="line"><span>   - ç»Ÿè®¡åˆ†æï¼šè¶‹åŠ¿åˆ†æã€å¼‚å¸¸æ£€æµ‹</span></span>
<span class="line"><span>   - å¯è§†åŒ–å±•ç¤ºï¼šå›¾è¡¨å±•ç¤ºåˆ†æç»“æœ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>5. ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š</span></span>
<span class="line"><span>   - ä¿ç•™ç­–ç•¥ï¼šä¸åŒç±»å‹æ—¥å¿—ä¿ç•™æœŸé™</span></span>
<span class="line"><span>   - è‡ªåŠ¨æ¸…ç†ï¼šè‡ªåŠ¨åˆ é™¤è¿‡æœŸæ—¥å¿—</span></span>
<span class="line"><span>   - åˆè§„è¦æ±‚ï¼šæ»¡è¶³æ³•è§„è¦æ±‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="å®æˆ˜ç»ƒä¹ å»ºè®®" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜ç»ƒä¹ å»ºè®®"><span>å®æˆ˜ç»ƒä¹ å»ºè®®</span></a></h2><h3 id="æŠ€èƒ½æå‡è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#æŠ€èƒ½æå‡è·¯å¾„"><span>æŠ€èƒ½æå‡è·¯å¾„</span></a></h3><ol><li><strong>ç›‘æ§ç³»ç»Ÿå®æˆ˜</strong>ï¼šæ­å»ºå®Œæ•´çš„Zabbix/Prometheusç›‘æ§ç¯å¢ƒ</li><li><strong>æ—¥å¿—åˆ†æå®æˆ˜</strong>ï¼šéƒ¨ç½²ELK Stackï¼Œåˆ†æå®é™…æ—¥å¿—æ•°æ®</li><li><strong>è‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘</strong>ï¼šç¼–å†™ç›‘æ§ã€å‘Šè­¦ã€æ¸…ç†è„šæœ¬</li><li><strong>æ€§èƒ½è°ƒä¼˜å®æˆ˜</strong>ï¼šåœ¨æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œæ€§èƒ½å‹æµ‹å’Œä¼˜åŒ–</li></ol><h3 id="é¢è¯•å‡†å¤‡è¦ç‚¹" tabindex="-1"><a class="header-anchor" href="#é¢è¯•å‡†å¤‡è¦ç‚¹"><span>é¢è¯•å‡†å¤‡è¦ç‚¹</span></a></h3><ol><li><strong>ç›‘æ§æŒ‡æ ‡è®¾è®¡</strong>ï¼šèƒ½å¤Ÿè®¾è®¡åˆç†çš„ç›‘æ§æŒ‡æ ‡ä½“ç³»</li><li><strong>å‘Šè­¦ç­–ç•¥åˆ¶å®š</strong>ï¼šèƒ½å¤Ÿåˆ¶å®šæœ‰æ•ˆçš„å‘Šè­¦ç­–ç•¥</li><li><strong>æˆæœ¬æ§åˆ¶ç»éªŒ</strong>ï¼šæœ‰å®é™…çš„æˆæœ¬ä¼˜åŒ–æ¡ˆä¾‹</li><li><strong>æ•…éšœå¤„ç†ç»éªŒ</strong>ï¼šé€šè¿‡ç›‘æ§å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜</li></ol><hr><p><em>å»ºè®®ç»“åˆå®é™…å·¥ä½œç¯å¢ƒè¿›è¡Œæ·±å…¥å®è·µï¼Œç§¯ç´¯ä¸°å¯Œçš„ç›‘æ§è¿ç»´ç»éªŒã€‚</em></p></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/SunshineCloudTech/SunshineCloudTech.github.io/edit/main/src/è¿ç»´ç¬”è®°/åº”è˜æŒ‡å—02-ç›‘æ§ä¼˜åŒ–.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°</span><time class="vp-meta-info" datetime="2025-08-17T15:39:00.000Z" data-allow-mismatch>2025/8/17 15:39</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: jamesmith0817@gmail.com">SunshineCloud</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9707-%E7%81%BE%E5%A4%87%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç¾å¤‡ç®¡ç†ä¸“é¡¹"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><i class="vp-icon fas fa-life-ring" sizing="height"></i>ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šç¾å¤‡ç®¡ç†ä¸“é¡¹</div></a><a class="route-link auto-link next" href="/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/%E5%BA%94%E8%81%98%E6%8C%87%E5%8D%9706-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86.html" aria-label="ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šé¡¹ç›®ç®¡ç†ä¸“é¡¹"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">ITç³»ç»Ÿè¿ç»´å·¥ç¨‹å¸ˆåº”è˜æŒ‡å—ï¼šé¡¹ç›®ç®¡ç†ä¸“é¡¹<i class="vp-icon fas fa-project-diagram" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">SunshineNotes Â© 2023-present SunshineCloud é‡æ„ç‰ˆ</div><div class="vp-copyright">Copyright Â© 2025 SunshineCloud </div></footer></div><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DbSsbPov.js" defer></script>
  </body>
</html>
